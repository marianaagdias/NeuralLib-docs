
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../architectures/">
      
      
        <link rel="next" href="../biosignals_architectures/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.2">
    
    
      
        <title>Architecture Class - NeuralLib Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#class-architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NeuralLib Documentation" class="md-header__button md-logo" aria-label="NeuralLib Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NeuralLib Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Architecture Class
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/marianaagdias/NeuralLib" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../architectures/" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../utils/" class="md-tabs__link">
          
  
  Utils

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../config/" class="md-tabs__link">
        
  
    
  
  Configuration

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NeuralLib Documentation" class="md-nav__button md-logo" aria-label="NeuralLib Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NeuralLib Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/marianaagdias/NeuralLib" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Architectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Architectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architectures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Architecture Class
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Architecture Class
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Class: Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class: Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#__init__self-architecture_name" class="md-nav__link">
    <span class="md-ellipsis">
      __init__(self, architecture_name)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint-and-training-information-management" class="md-nav__link">
    <span class="md-ellipsis">
      Checkpoint and Training Information Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_checkpoints_directoryself-retraining" class="md-nav__link">
    <span class="md-ellipsis">
      create_checkpoints_directory(self, retraining)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_training_informationself-trainer-optimizer-train_dataset_name-trained_for-val_loss-total_training_time-gpu_model-retraining-prev_training_historynone" class="md-nav__link">
    <span class="md-ellipsis">
      save_training_information(self, trainer, optimizer, train_dataset_name, trained_for, val_loss, total_training_time, gpu_model, retraining, prev_training_history=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_training_information_to_fileself-directory" class="md-nav__link">
    <span class="md-ellipsis">
      save_training_information_to_file(self, directory)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-training-and-retraining" class="md-nav__link">
    <span class="md-ellipsis">
      Model Training and Retraining
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_from_scratchself-path_x-path_y-patience-batch_size-epochs-gpu_idnone-all_samplesfalse-samplesnone-dataset_namenone-trained_fornone-classificationfalse-enable_tensorboardfalse" class="md-nav__link">
    <span class="md-ellipsis">
      train_from_scratch(self, path_x, path_y, patience, batch_size, epochs, gpu_id=None, all_samples=False, samples=None, dataset_name=None, trained_for=None, classification=False, enable_tensorboard=False)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrainself-path_x-path_y-patience-batch_size-epochs-gpu_idnone-all_samplesfalse-samplesnone-dataset_namenone-trained_fornone-classificationfalse-enable_tensorboardfalse-checkpoints_directorynone-hugging_face_modelnone" class="md-nav__link">
    <span class="md-ellipsis">
      retrain(self, path_x, path_y, patience, batch_size, epochs, gpu_id=None, all_samples=False, samples=None, dataset_name=None, trained_for=None, classification=False, enable_tensorboard=False, checkpoints_directory=None, hugging_face_model=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-testing-and-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Testing and Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test_on_test_setself-path_x-path_y-all_samplestrue-samplesnone-checkpoints_dirnone-gpu_idnone-save_predictionsfalse-post_process_fnnone" class="md-nav__link">
    <span class="md-ellipsis">
      test_on_test_set(self, path_x, path_y, all_samples=True, samples=None, checkpoints_dir=None, gpu_id=None, save_predictions=False, post_process_fn=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test_on_single_signalself-x-checkpoints_dirnone-gpu_idnone-post_process_fnnone" class="md-nav__link">
    <span class="md-ellipsis">
      test_on_single_signal(self, X, checkpoints_dir=None, gpu_id=None, post_process_fn=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auxiliary-functions-and-methods" class="md-nav__link">
    <span class="md-ellipsis">
      (Auxiliary) Functions and Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-get_weights_and_info_from_checkpointsprev_checkpoints_dir" class="md-nav__link">
    <span class="md-ellipsis">
      1. get_weights_and_info_from_checkpoints(prev_checkpoints_dir)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-get_weights_and_info_from_hugginghugging_face_model-local_dirnone" class="md-nav__link">
    <span class="md-ellipsis">
      2. get_weights_and_info_from_hugging(hugging_face_model, local_dir=None)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-get_hparams_from_checkpointscheckpoints_directory" class="md-nav__link">
    <span class="md-ellipsis">
      3. get_hparams_from_checkpoints(checkpoints_directory)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-get_hparams_from_hugginghugging_face_model" class="md-nav__link">
    <span class="md-ellipsis">
      4. get_hparams_from_hugging(hugging_face_model)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-validate_training_contextretraining-checkpoints_directory-hugging_face_model" class="md-nav__link">
    <span class="md-ellipsis">
      5. validate_training_context(retraining, checkpoints_directory, hugging_face_model)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../biosignals_architectures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Biosignals architectures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training deployment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_hub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Hub
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataset requirements
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Architecture Class</h1>

<h2 id="class-architecture">Class: <code>Architecture</code></h2>
<p><code>Architecture</code> class provides a framework for training, retraining, testing, and managing neural network models tailored for biosignal processing. It integrates with PyTorch Lightning to streamline training workflows, support checkpoint management, and enable logging via TensorBoard. It also includes utilities for loading pre-trained models from local directories or Hugging Face.</p>
<hr />
<h3 id="initialization"><strong>Initialization</strong></h3>
<h3 id="__init__self-architecture_name"><code>__init__(self, architecture_name)</code></h3>
<ul>
<li>Defines a base neural network model with <code>architecture_name</code>.</li>
<li>Initializes training history and checkpoint directory.</li>
</ul>
<hr />
<h3 id="checkpoint-and-training-information-management"><strong>Checkpoint and Training Information Management</strong></h3>
<h3 id="create_checkpoints_directoryself-retraining"><code>create_checkpoints_directory(self, retraining)</code></h3>
<ul>
<li>Creates a unique directory for storing model checkpoints.</li>
<li>Uses architecture parameters and timestamp for directory naming.</li>
<li>The directory follows the format: <code>{RESULTS_BASE_DIR}/{model_name}/checkpoints/{architecture_name}_{hid_dim}hid_{n_layers}l_lr{learning_rate}_drop{dropout}_{timestamp}</code>.</li>
</ul>
<p>If retraining, the directory name includes <code>_retraining</code> to differentiate from the initial training run.</p>
<h3 id="save_training_informationself-trainer-optimizer-train_dataset_name-trained_for-val_loss-total_training_time-gpu_model-retraining-prev_training_historynone"><code>save_training_information(self, trainer, optimizer, train_dataset_name, trained_for, val_loss, total_training_time, gpu_model, retraining, prev_training_history=None)</code></h3>
<ul>
<li>Stores information about the current training process, including dataset, optimizer, validation loss, and training time.</li>
<li>If retraining, appends previous training history.</li>
</ul>
<h3 id="save_training_information_to_fileself-directory"><code>save_training_information_to_file(self, directory)</code></h3>
<ul>
<li>Saves the training information dictionary to <code>training_info.json</code> in the given directory.</li>
</ul>
<hr />
<h3 id="model-training-and-retraining"><strong>Model Training and Retraining</strong></h3>
<h3 id="train_from_scratchself-path_x-path_y-patience-batch_size-epochs-gpu_idnone-all_samplesfalse-samplesnone-dataset_namenone-trained_fornone-classificationfalse-enable_tensorboardfalse"><code>train_from_scratch(self, path_x, path_y, patience, batch_size, epochs, gpu_id=None, all_samples=False, samples=None, dataset_name=None, trained_for=None, classification=False, enable_tensorboard=False)</code></h3>
<ul>
<li>Trains a model from scratch using PyTorch Lightning.</li>
<li>Initializes model, dataset, dataloaders, and training parameters.</li>
<li>Saves best checkpoint and logs training progress using TensorBoard.</li>
<li>Saves final weights in <code>.pth</code> format.</li>
</ul>
<p>Detailed breakdown of the function:</p>
<ol>
<li><strong>Setup &amp; Configuration:</strong></li>
</ol>
<p>The random seed is set, the device (CPU/GPU) is configured using <code>configure_device(gpu_id)</code>. Checks if TensorBoard is available.</p>
<ol>
<li><strong>Model Initialization &amp; Checkpoints:</strong></li>
</ol>
<p>A directory for storing model checkpoints is created in 
<code>&lt;DEV_BASE_DIR&gt;/results/&lt;model_name&gt;/checkpoints/&lt;architecture_name_hparams_datetime&gt;</code></p>
<ol>
<li><strong>Dataset &amp; DataLoader Preparation:</strong></li>
</ol>
<p>Training and validation datasets are instantiated from <code>DatasetSequence</code>, loading data from <code>path_x</code> (features) and <code>path_y</code> (labels). PyTorch <code>DataLoader</code> objects are created. The <code>collate_fn</code> function is used to handle dynamic sequence lengths.</p>
<ol>
<li><strong>Defining Callbacks for Training:</strong><ul>
<li><strong>Checkpoint Callback:</strong> Saves the best model based on validation loss (<code>val_loss</code>).</li>
<li><strong>Early Stopping Callback:</strong> Stops training early if validation loss doesn't improve for <code>patience</code> epochs.</li>
<li><strong>Loss Plot Callback:</strong> Saves a loss curve to visualize training progress.</li>
</ul>
</li>
<li><strong>Trainer Initialization &amp; Logging:</strong><ul>
<li>If TensorBoard is enabled, a <code>TensorBoardLogger</code> is set up for tracking metrics and hyperparameters (hparams.yaml)</li>
<li>The PyTorch Lightning <code>Trainer</code> is instantiated, specifying: maximum epochs (<code>epochs</code>), device, callbacks (Checkpointing, Early Stopping, Loss Plot), logging</li>
</ul>
</li>
<li><strong>Training Execution:</strong></li>
</ol>
<p>The model is trained using <code>trainer.fit(model, train_dataloader, val_dataloader)</code>.</p>
<ol>
<li><strong>Post-Training Processing &amp; Model Saving:</strong><ul>
<li>The <strong>best (lowest) validation loss</strong> is extracted from the checkpoint callback.</li>
<li>Training metadata (trainer state, optimizer, dataset, GPU info, loss, etc.) is saved (using <code>model.save_training_information()</code>) and written to <code>training_info.json</code> inside the checkpoint directory.</li>
<li>The <strong>final model weights</strong> (corresponding to the lowest validation loss) are saved in <code>model_weights.pth</code> inside the checkpoint directory.</li>
</ul>
</li>
</ol>
<h3 id="retrainself-path_x-path_y-patience-batch_size-epochs-gpu_idnone-all_samplesfalse-samplesnone-dataset_namenone-trained_fornone-classificationfalse-enable_tensorboardfalse-checkpoints_directorynone-hugging_face_modelnone"><code>retrain(self, path_x, path_y, patience, batch_size, epochs, gpu_id=None, all_samples=False, samples=None, dataset_name=None, trained_for=None, classification=False, enable_tensorboard=False, checkpoints_directory=None, hugging_face_model=None)</code></h3>
<ul>
<li>Loads model weights from a previous checkpoint or Hugging Face repository.</li>
<li>Performs training while preserving previous history. The main difference to <code>train_from_scratch</code> is<ul>
<li>retraining of the whole model (can be either to use additional/different data, to train for more epochs,..). If the purpose is to perform TL, use the <code>TLModel</code> class from <code>model_hub</code> package.</li>
</ul>
</li>
<li>Saves updated training information and final model weights.</li>
</ul>
<hr />
<h3 id="model-testing-and-evaluation"><strong>Model Testing and Evaluation</strong></h3>
<h3 id="test_on_test_setself-path_x-path_y-all_samplestrue-samplesnone-checkpoints_dirnone-gpu_idnone-save_predictionsfalse-post_process_fnnone"><code>test_on_test_set(self, path_x, path_y, all_samples=True, samples=None, checkpoints_dir=None, gpu_id=None, save_predictions=False, post_process_fn=None)</code></h3>
<ul>
<li>Evaluates the trained model on a test dataset.</li>
<li>Loads model weights from the checkpoint directory.</li>
<li>Returns predictions and average test loss.</li>
<li>Optionally saves predictions and applies post-processing functions.</li>
</ul>
<h3 id="test_on_single_signalself-x-checkpoints_dirnone-gpu_idnone-post_process_fnnone"><code>test_on_single_signal(self, X, checkpoints_dir=None, gpu_id=None, post_process_fn=None)</code></h3>
<ul>
<li>Tests the model on a single input signal.</li>
<li>Loads model weights from the checkpoint directory.</li>
<li>Returns the predicted output, optionally applying post-processing.</li>
</ul>
<hr />
<h3 id="auxiliary-functions-and-methods"><strong>(Auxiliary) Functions and Methods</strong></h3>
<h3 id="1-get_weights_and_info_from_checkpointsprev_checkpoints_dir">1. <code>get_weights_and_info_from_checkpoints(prev_checkpoints_dir)</code></h3>
<ul>
<li>Extracts model weights (<code>.pth</code>) and training history (<code>training_info.json</code>) from a given checkpoint directory.</li>
<li>If <code>.pth</code> is unavailable, converts <code>.ckpt</code> to <code>.pth</code>.</li>
<li>Returns the path to the weights file and training history.</li>
</ul>
<h3 id="2-get_weights_and_info_from_hugginghugging_face_model-local_dirnone">2. <code>get_weights_and_info_from_hugging(hugging_face_model, local_dir=None)</code></h3>
<ul>
<li>Downloads model weights and training history from a Hugging Face repository.</li>
<li>Returns the local path to the weights and training history file.</li>
</ul>
<h3 id="3-get_hparams_from_checkpointscheckpoints_directory">3. <code>get_hparams_from_checkpoints(checkpoints_directory)</code></h3>
<ul>
<li>Retrieves hyperparameters from the latest version of <code>hparams.yaml</code> in a checkpoint directory.</li>
<li>Ensures the existence of relevant log directories.</li>
</ul>
<p><strong>Example (from tutorial 2 - grid search):</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">NeuralLib.architectures</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_hparams_from_checkpoints</span><span class="p">,</span> <span class="n">GRUseq2seq</span>
<span class="n">architecture_params</span> <span class="o">=</span> <span class="n">get_hparams_from_checkpoints</span><span class="p">(</span><span class="n">best_dir</span><span class="p">)</span>
<span class="c1"># Initialize the model using the loaded parameters</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GRUseq2seq</span><span class="p">(</span><span class="o">**</span><span class="n">architecture_params</span><span class="p">)</span>
</code></pre></div>
<h3 id="4-get_hparams_from_hugginghugging_face_model">4. <code>get_hparams_from_hugging(hugging_face_model)</code></h3>
<ul>
<li>Downloads hyperparameters (<code>hparams.yaml</code>) from a Hugging Face repository.</li>
<li>Returns hyperparameters as a dictionary.</li>
</ul>
<h3 id="5-validate_training_contextretraining-checkpoints_directory-hugging_face_model">5. <code>validate_training_context(retraining, checkpoints_directory, hugging_face_model)</code></h3>
<ul>
<li>Ensures correct conditions for training (<code>retraing=False</code>) and retraining (<code>retraing=True</code>).</li>
<li>Raises errors if checkpoints are missing when retraining or provided when training from scratch.</li>
</ul>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "toc.integrate", "search.suggest", "search.highlight", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f13b1293.min.js"></script>
      
    
  </body>
</html>